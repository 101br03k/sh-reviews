<!DOCTYPE html>
<html>
<head>
  <title>Edit Review</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="icon" type="image/x-icon" href="/SH-Reviews-logo/icon.png">
  <link rel="apple-touch-icon" href="/SH-Reviews-logo/icon.png">
</head>
<body>
  <div class="container">
    <h1>Edit Review</h1>
    <form action="/update/<%= review.id %>" method="POST" enctype="multipart/form-data">
      <input type="text" name="title" value="<%= review.title %>" required>
      <div class="preview-label">Title Preview:</div>
      <div class="title-preview" style="margin-bottom:1em;"><%- review.title_html %></div>
      <textarea name="review" required><%= review.review %></textarea><br>
      <div class="preview-label">Review Preview:</div>
      <div class="review-preview" style="margin-bottom:1em;"><%- review.review_html %></div>
      <div>
        <label>Current Image:</label><br>
        <img id="current-image" src="<%= review.image %>" alt="Current Image" style="max-width: 100%;">
      </div>
      Select Rating:
      <select name="rating" required>
        <option value="">Select Rating</option>
        <option value="1" <%= review.rating == 1 ? 'selected' : '' %>>1 Star</option>
        <option value="2" <%= review.rating == 2 ? 'selected' : '' %>>2 Stars</option>
        <option value="3" <%= review.rating == 3 ? 'selected' : '' %>>3 Stars</option>
        <option value="4" <%= review.rating == 4 ? 'selected' : '' %>>4 Stars</option>
        <option value="5" <%= review.rating == 5 ? 'selected' : '' %>>5 Stars</option>
      </select><br><br>
      <div>
        <label for="image">Change Image:</label>
        <input type="file" id="image" name="image" accept="image/*">
      </div><br>
      <button type="submit">Update Review</button>
      <a href="/" class="button">Cancel Edit</a>
      <form action="/delete/<%= review.id %>" method="POST" style="display:inline;">
        <button class="delete" type="submit" onclick="return confirm('Are you sure you want to delete this review?');">Delete</button>
      </form>
    </form>
  </div>
  <script>
  document.getElementById('image').addEventListener('change', function(event) {
    const [file] = event.target.files;
    if (file) {
      const img = document.getElementById('current-image');
      img.src = URL.createObjectURL(file);
    }
  });
</script>
</body>
</html>